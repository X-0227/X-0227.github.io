<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>受害者的情感</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#ff6b8b',
                        secondary: '#ff9aa2',
                        accent: '#ffb7b2',
                        light: '#ffe6f0',
                        dark: '#5a3921',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            }
            .animate-float {
                animation: float 6s ease-in-out infinite;
            }
            .animate-appear {
                animation: appear 2s forwards;
            }
            .animate-scale-up {
                animation: scale-up 3s forwards;
            }
            .music-spin {
                animation: spin 4s linear infinite;
            }
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }

        @keyframes appear {
            0% { 
                opacity: 0;
                transform: scale(0.2);
            }
            100% { 
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes scale-up {
            0% { 
                transform: scale(1);
                opacity: 1;
            }
            100% { 
                transform: scale(10);
                opacity: 0;
            }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .word-item {
            position: absolute;
            pointer-events: none;
            user-select: none;
            white-space: nowrap;
        }
    </style>
</head>
<body class="bg-light min-h-screen overflow-hidden relative">
    <!-- 初始页面 -->
    <div id="intro-page" class="fixed inset-0 flex flex-col items-center justify-center p-4 z-50">
        <!-- 背景装饰元素 -->
        <div class="fixed inset-0 overflow-hidden">
            <div class="absolute top-1/4 left-1/3 w-64 h-64 rounded-full bg-primary/10 animate-float"></div>
            <div class="absolute bottom-1/3 right-1/4 w-80 h-80 rounded-full bg-secondary/10 animate-float" style="animation-delay: 2s;"></div>
            <div class="absolute top-1/2 right-1/2 w-40 h-40 rounded-full bg-accent/10 animate-float" style="animation-delay: 4s;"></div>
        </div>

        <header class="text-center mb-10 z-10">
            <h1 class="leading-tight">
                <p class="text-[clamp(1.5rem,5vw,2.5rem)] font-medium text-dark mb-1">权力不对等下性侵案件</p>
                <p class="text-[clamp(1.5rem,5vw,2.5rem)] font-medium text-dark mb-2">受害者的</p>
                <span class="text-[clamp(2.5rem,8vw,5rem)] font-bold text-primary block">内心世界</span>
            </h1>
        </header>

        <button id="start-btn" class="bg-primary hover:bg-primary/90 text-white font-bold py-4 px-12 rounded-full transition-all duration-300 transform hover:scale-105 hover:shadow-lg text-[clamp(1.2rem,3vw,1.5rem)] flex items-center z-10">
            <i class="fa fa-heartbeat mr-3"></i> 开始体验
        </button>

        <div class="absolute top-6 right-6 z-10">
            <button id="music-toggle" class="text-primary hover:text-primary/70 transition-colors">
                <i class="fa fa-music text-3xl music-spin"></i>
            </button>
        </div>
    </div>

    <!-- 体验页面 -->
    <div id="experience-page" class="fixed inset-0 hidden">
        <!-- 背景装饰元素 -->
        <div class="fixed inset-0 overflow-hidden">
            <div class="absolute top-1/4 left-1/3 w-64 h-64 rounded-full bg-primary/10 animate-float"></div>
            <div class="absolute bottom-1/3 right-1/4 w-80 h-80 rounded-full bg-secondary/10 animate-float" style="animation-delay: 2s;"></div>
            <div class="absolute top-1/2 right-1/2 w-40 h-40 rounded-full bg-accent/10 animate-float" style="animation-delay: 4s;"></div>
        </div>

        <div id="word-container" class="fixed inset-0"></div>

        <div class="absolute top-6 right-6 z-10">
            <button id="back-btn" class="bg-dark/30 hover:bg-dark/50 text-white font-bold py-2 px-4 rounded-full transition-all duration-300 flex items-center">
                <i class="fa fa-arrow-left mr-2"></i> 返回
            </button>
        </div>
    </div>

    <!-- 音频元素 -->
    <audio id="bg-music" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg" />
    </audio>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 词库及对应颜色
            const words = [
                { text: "沉默", color: "#ff6b8b" },
                { text: "权力", color: "#ff4757" },
                { text: "不敢说不", color: "#a4b0be" },
                { text: "他是老师", color: "#ff7f50" },
                { text: "他是老板", color: "#ff6b8b" },
                { text: "他是亲戚", color: "#ff4757" },
                { text: "羞耻", color: "#a4b0be" },
                { text: "被利用", color: "#ff7f50" },
                { text: "害怕失去机会", color: "#ff6b8b" },
                { text: "不被相信", color: "#ff4757" },
                { text: "被责怪", color: "#a4b0be" },
                { text: "无法逃脱", color: "#ff7f50" },
                { text: "绝望", color: "#ff6b8b" },
                { text: "反复否认", color: "#ff4757" },
                { text: "肯定是你有问题", color: "#a4b0be" },
                { text: "自责", color: "#ff7f50" },
                { text: "社会眼光", color: "#ff6b8b" },
                { text: "职场潜规则", color: "#ff4757" },
                { text: "你为什么不跑", color: "#a4b0be" },
                { text: "他说我勾引他", color: "#ff7f50" },
                { text: "明明是你自愿的", color: "#ff6b8b" },
                { text: "清白", color: "#ff4757" },
                { text: "控制", color: "#a4b0be" },
                { text: "沉重", color: "#ff7f50" },
                { text: "封口", color: "#ff6b8b" },
                { text: "强迫顺从", color: "#ff4757" },
                { text: "退无可退", color: "#a4b0be" },
                { text: "很想喊出来", color: "#ff7f50" },
                { text: "说出来会更糟", color: "#ff6b8b" },
                { text: "不敢跟任何人讲", color: "#ff4757" },
                { text: "我没有证据", color: "#a4b0be" },
                { text: "警察会信我吗", color: "#ff7f50" },
                { text: "是不是我太敏感", color: "#ff6b8b" },
                { text: "反正他说了算", color: "#ff4757" },
                { text: "我怕连工作都保不住", color: "#a4b0be" },
                { text: "他说只是玩笑", color: "#ff7f50" },
                { text: "我是不是太天真", color: "#ff6b8b" },
                { text: "我不敢回忆", color: "#ff4757" },
                { text: "我只能假装没事", color: "#a4b0be" },
                { text: "她为什么要现在才说", color: "#ff7f50" },
                { text: "你看她穿成那样", color: "#ff6b8b" },
                { text: "他家有背景", color: "#ff4757" },
                { text: "我说了也没用", color: "#a4b0be" },
                { text: "你不是第一个", color: "#ff7f50" },
                { text: "你想红吧", color: "#ff6b8b" },
                { text: "她也没受伤啊", color: "#ff4757" },
                { text: "不就是摸了一下", color: "#a4b0be" },
                { text: "再说别人也这么干", color: "#ff7f50" },
                { text: '迷茫', color: '#ff6b8b' },
                { text: '恐惧', color: '#ff4757' },
                { text: '麻痹', color: '#a4b0be' },
                { text: '挣扎', color: '#ff7f50' },
                { text: '自我怀疑', color: '#70a1ff' },
                { text: '羞耻', color: '#ff6b8b' },
                { text: '无助', color: '#57606f' },
                { text: '困惑', color: '#747d8c' },
                { text: '沉默', color: '#2f3542' },
                { text: '痛苦', color: '#ff4757' },
                { text: '绝望', color: '#2c3e50' },
                { text: '崩溃', color: '#e74c3c' },
                { text: '孤独', color: '#5352ed' },
                { text: '压抑', color: '#2d3436' },
                { text: '自我否定', color: '#a4b0be' },
                { text: '分裂', color: '#636e72' },
                { text: '焦虑', color: '#f1c40f' },
                { text: '抑郁', color: '#34495e' },
                { text: '创伤', color: '#e67e22' },
                { text: '解离', color: '#9b59b6' }
            ];

            const introPage = document.getElementById('intro-page');
            const experiencePage = document.getElementById('experience-page');
            const wordContainer = document.getElementById('word-container');
            const startBtn = document.getElementById('start-btn');
            const backBtn = document.getElementById('back-btn');
            const musicToggle = document.getElementById('music-toggle');
            const bgMusic = document.getElementById('bg-music');

            let spawnInterval;

            // 打乱词库顺序
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            // 创建新的词语元素
            function createWordElement(wordObj, isCentered = false) {
                const wordEl = document.createElement('div');
                wordEl.className = 'word-item';
                wordEl.textContent = wordObj.text;
                wordEl.style.color = wordObj.color;
                wordEl.style.fontSize = 'clamp(1.5rem, 5vw, 3rem)';
                wordEl.style.opacity = '0';
                wordEl.style.transform = 'scale(0.2)';
                wordEl.style.fontWeight = 'bold';

                if (isCentered) {
                    // 页面居中位置（减去字体宽高估值以使更居中）
                    const centerX = window.innerWidth / 2 - 80;
                    const centerY = window.innerHeight / 2 - 40;
                    wordEl.style.left = `${centerX}px`;
                    wordEl.style.top = `${centerY}px`;
                } else {
                    const maxX = window.innerWidth - 300;
                    const maxY = window.innerHeight - 150;
                    const x = Math.max(0, Math.random() * maxX);
                    const y = Math.max(0, Math.random() * maxY);
                    wordEl.style.left = `${x}px`;
                    wordEl.style.top = `${y}px`;
                }

                wordContainer.appendChild(wordEl);

                // 动画效果
                setTimeout(() => {
                    wordEl.style.transition = 'all 2s ease-out';
                    wordEl.style.opacity = '1';
                    wordEl.style.transform = 'scale(1)';

                    setTimeout(() => {
                        wordEl.style.transition = 'all 5s ease-in-out';
                        wordEl.style.transform = 'scale(10)';
                        wordEl.style.opacity = '0';

                        setTimeout(() => {
                            if (wordEl.parentNode) {
                                wordEl.parentNode.removeChild(wordEl);
                            }
                        }, 5000);
                    }, 3000);
                }, 100);

                return wordEl;
            }

            // 从词库里随机抽取count个不重复词语索引
			function getUniqueRandomIndices(count, max) {
				const indices = new Set();
				while (indices.size < count) {
					indices.add(Math.floor(Math.random() * max));
				}
				return Array.from(indices);
			}

			// 开始生成词语
			function startSpawningWords() {
				wordContainer.innerHTML = '';

				shuffleArray(words);

				const totalWords = 3;
				// 先随机取3个不同的词索引
				const indices = getUniqueRandomIndices(totalWords, words.length);

				for (let i = 0; i < totalWords; i++) {
					setTimeout(() => {
						if (i === 0) {
							createWordElement(words[indices[i]], true);
						} else {
							createWordElement(words[indices[i]]);
						}
					}, i * 300);
				}

				clearInterval(spawnInterval);
				spawnInterval = setInterval(() => {
					// 每次间隔也只生成一个词，无需去重，保持简单
					const randomIndex = Math.floor(Math.random() * words.length);
					createWordElement(words[randomIndex]);
				}, 1000);
			}


            // 切换到体验页面
            function showExperiencePage() {
                introPage.classList.add('hidden');
                experiencePage.classList.remove('hidden');
                startSpawningWords();
                // 点击开始按钮时强制播放音乐
                bgMusic.play().catch(e => console.log('播放音乐失败:', e));
            }

            // 切换到介绍页面
            function showIntroPage() {
                experiencePage.classList.add('hidden');
                introPage.classList.remove('hidden');
                clearInterval(spawnInterval);
            }

            // 音乐控制
            function toggleMusic() {
                if (bgMusic.paused) {
                    bgMusic.play().catch(e => console.log('无法自动播放音乐:', e));
                    musicToggle.innerHTML = '<i class="fa fa-volume-up text-3xl music-spin"></i>';
                } else {
                    bgMusic.pause();
                    musicToggle.innerHTML = '<i class="fa fa-music text-3xl"></i>';
                }
            }

            // 绑定事件
            startBtn.addEventListener('click', () => {
                showExperiencePage();
            });
            backBtn.addEventListener('click', showIntroPage);
            musicToggle.addEventListener('click', toggleMusic);

            // 页面加载时尝试自动播放音乐（浏览器可能限制）
            bgMusic.play().catch(e => console.log('无法自动播放音乐:', e));
        });

		    // 情感体会.html中的返回按钮事件
    document.getElementById('back-btn').addEventListener('click', () => {
        // 获取URL参数中指定的返回位置
        const params = new URLSearchParams(window.location.search);
        const returnTo = params.get('returnTo') || 'page2'; // 返回第2页
        
        // 跳回原页面并定位到指定部分
        window.location.href = 'X-0227.github.io/index.html#${returnTo}`;
    });

    </script>
</body>
</html>
